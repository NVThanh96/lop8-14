<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ƒê∆∞·ªùng ƒë·∫øn ng√¥i vua - Game Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- Game particles effect -->
    <div class="game-particles" id="particles"></div>

    <div class="sidebar">
      <div class="nav-icon active" onclick="showTab('home')" title="Trang ch·ªß">
        <span>üè†</span>
      </div>
      <div class="nav-icon" onclick="showTab('students')" title="H·ªçc sinh">
        <span>üë•</span>
      </div>
      <div class="nav-icon" onclick="showTab('groups')" title="Nh√≥m">
        <span>üìä</span>
      </div>
      <div class="nav-icon" onclick="showTab('features')" title="T√≠nh nƒÉng">
        <span>‚ö°</span>
      </div>
      <div class="nav-icon" onclick="showTab('rewards')" title="ƒê·ªïi qu√†">
        <span>üéÅ</span>
      </div>
      <div class="nav-icon" onclick="showTab('reports')" title="B√°o c√°o">
        <span>üìà</span>
      </div>
      <div class="nav-icon" onclick="showTab('settings')" title="C√†i ƒë·∫∑t">
        <span>‚öôÔ∏è</span>
      </div>
    </div>

    <div class="main-content">
      <div class="left-section">
        <div class="header">
          <div class="greeting">
            <img src="/data/bia.png" alt="ƒê∆∞·ªùng ƒë·∫øn ng√¥i vua" />
          </div>
          <div class="header-right">
            <button onclick="showPointBoard()" class="btn-game">
              ‚ú® B·∫£ng ƒëi·ªÉm c·ªông tr·ª´
            </button>
            <button onclick="resetAllPoints()" class="btn-game">
              üîÑ ƒê·∫∑t l·∫°i ƒëi·ªÉm
            </button>
            <div
              class="icon-btn btn-game historyList"
              onclick="showHistoryModal()"
              title="L·ªãch s·ª≠"
              style="
                background: linear-gradient(135deg, #42a5f5 0%, #ff7043 100%);
                color: white;
                border: none;
                padding: 12px;
                border-radius: 50%;
                cursor: pointer;
                font-size: 1.2rem;
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                justify-content: center;
              "
            >
              <svg
                width="26"
                height="26"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.2))"
              >
                <!-- V√≤ng tr√≤n ƒë·ªìng h·ªì (m·ªü b√™n tr√°i) -->
                <circle
                  cx="12"
                  cy="12"
                  r="9"
                  stroke="currentColor"
                  stroke-width="2.5"
                  fill="none"
                  stroke-dasharray="20 4"
                  stroke-dashoffset="2"
                />
                <!-- Kim gi·ªù (10 gi·ªù) - ng·∫Øn h∆°n -->
                <line
                  x1="12"
                  y1="12"
                  x2="9.5"
                  y2="9.5"
                  stroke="currentColor"
                  stroke-width="3"
                  stroke-linecap="round"
                />
                <!-- Kim ph√∫t (45 ph√∫t) - d√†i h∆°n -->
                <line
                  x1="12"
                  y1="12"
                  x2="14.5"
                  y2="16.5"
                  stroke="currentColor"
                  stroke-width="2.5"
                  stroke-linecap="round"
                />
                <!-- M≈©i t√™n cong quay ng∆∞·ª£c chi·ªÅu kim ƒë·ªìng h·ªì (t·ª´ tr√™n ph·∫£i xu·ªëng tr√°i) -->
                <path
                  d="M19 5 Q22 7 22 10 Q22 13 19 15"
                  stroke="currentColor"
                  stroke-width="2.5"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path d="M19 15 L17 13 L19 11 Z" fill="currentColor" />
              </svg>
            </div>
          </div>
        </div>

        <!-- Trang ch·ªß -->
        <div id="home-tab" class="tab-content active">
          <div class="devices-section">
            <!-- Trang b√¨a v√† Top 5/Top 3 -->
            <div class="devices-section-group">
              <div class="devices-section-left">
                <div class="imgBia">
                  <img src="data/bia.png" alt="ƒê∆∞·ªùng ƒë·∫øn ng√¥i vua" />
                </div>

                <!-- Stats grid - Thu nh·ªè v√† ƒë·∫∑t d∆∞·ªõi trang b√¨a -->
                <div class="stats-grid">
                  <!-- T·ªïng h·ªçc sinh -->
                  <div class="stat-card">
                    <div class="stat-card-flex">
                      <div class="stat-card-left">
                        <h3>T·ªïng h·ªçc sinh</h3>
                        <div class="stat-card-group">
                          <span class="stat-value" id="totalStudents">0</span>
                          <span class="stat-unit">HS</span>
                        </div>
                      </div>
                      <div class="stat-icon temp-icon stat-card-right">
                        <img src="data/nhom2.png" alt="T·ªïng" />
                      </div>
                    </div>
                  </div>

                  <!-- D√¢n th∆∞·ªùng -->
                  <div class="stat-card">
                    <div class="stat-card-flex">
                      <div class="stat-card-left">
                        <h3>D√¢n th∆∞·ªùng</h3>
                        <div class="stat-card-group">
                          <span class="stat-value" id="commonStudents">0</span>
                          <span class="stat-unit">HS</span>
                        </div>
                      </div>
                      <div class="stat-icon temp-icon stat-card-right">
                        <img src="data/dan.png" alt="D√¢n th∆∞·ªùng" />
                      </div>
                    </div>
                  </div>

                  <!-- L√≠nh -->
                  <div class="stat-card">
                    <div class="stat-card-flex">
                      <div class="stat-card-left">
                        <h3>L√≠nh</h3>
                        <div class="stat-card-group">
                          <span class="stat-value" id="soldierStudents">0</span>
                          <span class="stat-unit">HS</span>
                        </div>
                      </div>
                      <div class="stat-icon temp-icon stat-card-right">
                        <img src="data/linh.png" alt="L√≠nh" />
                      </div>
                    </div>
                  </div>

                  <!-- Quan -->
                  <div class="stat-card">
                    <div class="stat-card-flex">
                      <div class="stat-card-left">
                        <h3>Quan</h3>
                        <div class="stat-card-group">
                          <span class="stat-value" id="officialStudents"
                            >0</span
                          >
                          <span class="stat-unit">HS</span>
                        </div>
                      </div>
                      <div class="stat-icon temp-icon stat-card-right">
                        <img src="data/quan.png" alt="Quan" />
                      </div>
                    </div>
                  </div>

                  <!-- T·ªÉ t∆∞·ªõng -->
                  <div class="stat-card">
                    <div class="stat-card-flex">
                      <div class="stat-card-left">
                        <h3>T·ªÉ t∆∞·ªõng</h3>
                        <div class="stat-card-group">
                          <span class="stat-value" id="primeStudents">0</span>
                          <span class="stat-unit">HS</span>
                        </div>
                      </div>
                      <div class="stat-icon temp-icon stat-card-right">
                        <img src="data/tetuong.png" alt="T·ªÉ t∆∞·ªõng" />
                      </div>
                    </div>
                  </div>

                  <!-- Vua -->
                  <div class="stat-card">
                    <div class="stat-card-flex">
                      <div class="stat-card-left">
                        <h3>Vua</h3>
                        <div class="stat-card-group">
                          <span class="stat-value" id="kingStudents">0</span>
                          <span class="stat-unit">HS</span>
                        </div>
                      </div>
                      <div class="stat-icon temp-icon stat-card-right">
                        <img src="data/vua.png" alt="Vua" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="devices-section-right">
                <div class="members-card">
                  <h3>Top 5 h·ªçc sinh</h3>
                  <div class="members-list" id="topStudentsList">
                    <!-- Top h·ªçc sinh s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
                  </div>
                </div>
              </div>
            </div>

            <!-- Top 3 nh√≥m - Hi·ªÉn th·ªã to√†n chi·ªÅu ngang -->
            <div class="my-devices-card">
              <h3>Top 3 nh√≥m</h3>
              <div class="my-devices-grid" id="topGroupsList">
                <!-- Top nh√≥m s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
              </div>
            </div>
          </div>
        </div>

        <!-- H·ªçc sinh -->
        <div id="students-tab" class="tab-content">
          <div class="devices-section">
            <div class="devices-section-listStudents">
              <h3>Danh s√°ch h·ªçc sinh</h3>
              <div class="btn-options">
                <!-- Toggle View Switch -->
                <div class="btn-first">
                  <span>Giao di·ªán:</span>
                  <button id="viewToggleBtn" onclick="toggleStudentView()">
                    Th·∫ª l·ªõn
                  </button>
                </div>

                <div class="btn-second">
                  <button
                    id="selectMultipleBtn"
                    onclick="toggleSelectMultiple()"
                  >
                    Ch·ªçn nhi·ªÅu
                  </button>
                  <button id="selectAllBtn" onclick="selectAllStudents()">
                    Ch·ªçn t·∫•t c·∫£
                  </button>
                </div>

                <div id="bulkControls">
                  <button class="btnSub" onclick="subtractPointsFromSelected()">
                    -
                  </button>
                  <input type="number" id="bulkPoints" value="1" min="1" />
                  <button class="btnAdd" onclick="addPointsToSelected()">
                    +
                  </button>
                </div>
              </div>
            </div>
            <div class="student-grid-compact" id="studentGrid">
              <!-- H·ªçc sinh s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
            </div>
          </div>
        </div>

        <!-- Nh√≥m -->
        <div id="groups-tab" class="tab-content">
          <div class="devices-section">
            <div class="devices-section-groupStudents">
              <h3>Qu·∫£n l√Ω nh√≥m</h3>

              <div class="btn-first">
                <button class="btn-auto" onclick="showAddGroupModal()">
                  Th√™m nh√≥m
                </button>
                <button id="selectGroupsBtn" onclick="toggleSelectGroups()">
                  Ch·ªçn nhi·ªÅu
                </button>
                <button id="selectAllGroupsBtn" onclick="selectAllGroups()">
                  ‚úì Ch·ªçn t·∫•t c·∫£
                </button>
                <button class="resetAllGroups" onclick="resetAllGroups()">
                  X√≥a t·∫•t c·∫£ nh√≥m
                </button>

                <div id="groupBulkControls">
                  <button
                    class="btnSub"
                    onclick="subtractPointsFromSelectedGroups()"
                  >
                    -
                  </button>
                  <input type="number" id="groupBulkPoints" value="1" min="1" />
                  <button class="btnAdd" onclick="addPointsToSelectedGroups()">
                    +
                  </button>

                  <button
                    onclick="deleteSelectedGroups()"
                    style="
                      background: linear-gradient(45deg, #ff4757, #ff6b6b);
                      color: white;
                      border: none;
                      padding: 8px 12px;
                      border-radius: 8px;
                      cursor: pointer;
                    "
                  >
                    X√≥a
                  </button>
                </div>
              </div>
            </div>
            <div class="groups-grid" id="groupsGrid">
              <!-- Nh√≥m s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
            </div>
          </div>
        </div>

        <!-- T√≠nh nƒÉng -->
        <div id="features-tab" class="tab-content">
          <div class="devices-section">
            <h3 style="color: #4a5568; margin-bottom: 20px; font-size: 1.5rem">
              T√≠nh nƒÉng b·ªï tr·ª£
            </h3>
            <div class="features-grid">
              <div class="feature-card" onclick="showTimerModal()">
                <div class="feature-icon">‚è±Ô∏è</div>
                <div class="feature-name">B·∫•m gi·ªù</div>
                <div class="feature-timer" id="timerDisplay">00:00:00</div>
              </div>
              <div class="feature-card" onclick="showRandomCallModal()">
                <div class="feature-icon">üé≤</div>
                <div class="feature-name">G·ªçi t√™n ng·∫´u nhi√™n</div>
                <div class="feature-result" id="randomResult">B·∫•m ƒë·ªÉ g·ªçi</div>
              </div>
              <div class="feature-card" onclick="showSoundModal()">
                <div class="feature-icon">üîä</div>
                <div class="feature-name">ƒêo √¢m thanh</div>
                <div class="feature-meter" id="soundMeter">Ch·ªçn ch·∫ø ƒë·ªô</div>
              </div>
            </div>
          </div>
        </div>

        <!-- C√†i ƒë·∫∑t -->
        <div id="settings-tab" class="tab-content">
          <div class="devices-section settings" >
            <h3 style="color: #4a5568; margin-bottom: 20px; font-size: 1.5rem">
              C√†i ƒë·∫∑t v√† qu·∫£n l√Ω
            </h3>
            <div
              style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px"
            >
              <div>
                <h4 style="margin-bottom: 15px">Th√™m h·ªçc sinh</h4>
                <textarea
                  id="bulkStudentNamesSettings"
                  rows="6"
                  style="
                    width: 100%;
                    padding: 10px;
                    border-radius: 12px;
                    border: 1px solid #eee;
                  "
                  placeholder="M·ªói d√≤ng m·ªôt t√™n h·ªçc sinh"
                ></textarea>
                <button
                  class="btn-auto"
                  onclick="handleAddMultipleStudents('bulkStudentNamesSettings')"
                  style="
                    background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 12px;
                    cursor: pointer;
                    margin-top: 10px;
                  "
                >
                  Th√™m h·ªçc sinh
                </button>

                <h4 style="margin: 20px 0 15px">üìä Thi·∫øt l·∫≠p b·∫£ng ƒëi·ªÉm</h4>

                <!-- ƒêi·ªÉm C·ªông -->
                <div style="margin-bottom: 25px">
                  <div
                    style="
                      font-weight: 700;
                      margin-bottom: 10px;
                      color: #28a745;
                      font-size: 1.5rem;
                    "
                  >
                    ‚úÖ ƒêi·ªÉm C·ªông:
                  </div>
                  <div
                    id="addCriteriaContainer"
                    style="
                      background: #f8f9fa;
                      border: 2px solid #e0e0e0;
                      border-radius: 12px;
                      padding: 15px;
                      margin-bottom: 10px;
                      min-height: 100px;
                    "
                  >
                    <!-- Ti√™u ch√≠ s·∫Ω ƒë∆∞·ª£c load ·ªü ƒë√¢y -->
                  </div>
                  <button
                    onclick="addNewCriteria('add')"
                    style="
                      background: linear-gradient(45deg, #4caf50, #66bb6a);
                      color: white;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 10px;
                      cursor: pointer;
                      font-weight: bold;
                      width: 100%;
                    "
                  >
                    + Th√™m ti√™u ch√≠
                  </button>
                </div>

                <!-- ƒêi·ªÉm Tr·ª´ -->
                <div style="margin-bottom: 25px">
                  <div
                    style="
                      font-weight: 700;
                      margin-bottom: 10px;
                      color: #dc3545;
                      font-size: 1.5rem;
                    "
                  >
                    ‚ùå ƒêi·ªÉm Tr·ª´:
                  </div>
                  <div
                    id="subtractCriteriaContainer"
                    style="
                      background: #f8f9fa;
                      border: 2px solid #e0e0e0;
                      border-radius: 12px;
                      padding: 15px;
                      margin-bottom: 10px;
                      min-height: 100px;
                    "
                  >
                    <!-- Ti√™u ch√≠ s·∫Ω ƒë∆∞·ª£c load ·ªü ƒë√¢y -->
                  </div>
                  <button
                    onclick="addNewCriteria('subtract')"
                    style="
                      background: linear-gradient(45deg, #f44336, #ef5350);
                      color: white;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 10px;
                      cursor: pointer;
                      font-weight: bold;
                      width: 100%;
                    "
                  >
                    + Th√™m ti√™u ch√≠
                  </button>
                </div>

                <button
                  onclick="saveAllCriteria()"
                  style="
                    background: linear-gradient(45deg, #ffca28, #ffe082);
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    border-radius: 12px;
                    cursor: pointer;
                    font-weight: bold;
                    width: 100%;
                    font-size: 1.5rem;
                  "
                >
                  üíæ L∆∞u t·∫•t c·∫£
                </button>
              </div>
              <div>
                <h4 style="margin-bottom: 15px">ƒêi·ªÉm y√™u c·∫ßu m·ªói m·ªëc</h4>
                <div id="thresholdEditor"></div>
                <button
                  class="btn-auto"
                  onclick="saveThresholds()"
                  style="
                    background: linear-gradient(45deg, #ffca28, #ffe082);
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 12px;
                    cursor: pointer;
                    margin-top: 10px;
                  "
                >
                  L∆∞u m·ªëc
                </button>

                <h4 style="margin: 20px 0 15px">Thi·∫øt l·∫≠p hi·ªán t·∫°i</h4>
                <div
                  id="thresholdTable"
                  style="background: #f8f9fa; border-radius: 8px; padding: 15px"
                >
                  <table style="width: 100%; border-collapse: collapse">
                    <thead>
                      <tr style="background: #e9ecef">
                        <th
                          style="
                            padding: 8px;
                            border: 1px solid #dee2e6;
                            text-align: left;
                          "
                        >
                          C·∫•p b·∫≠c
                        </th>
                        <th
                          style="
                            padding: 8px;
                            border: 1px solid #dee2e6;
                            text-align: center;
                          "
                        >
                          ƒêi·ªÉm y√™u c·∫ßu
                        </th>
                        <th
                          style="
                            padding: 8px;
                            border: 1px solid #dee2e6;
                            text-align: center;
                          "
                        >
                          H·ªá s·ªë
                        </th>
                      </tr>
                    </thead>
                    <tbody id="thresholdTableBody">
                      <!-- S·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t ƒë·ªông -->
                    </tbody>
                  </table>
                </div>

                <h4 style="margin: 20px 0 15px">X√≥a h·ªçc sinh</h4>
                <div
                  style="
                    background: #fff3cd;
                    border: 1px solid #ffc107;
                    border-radius: 8px;
                    padding: 15px;
                    margin-bottom: 20px;
                  "
                >
                  <div
                    style="
                      font-weight: 700;
                      margin-bottom: 10px;
                      color: #856404;
                    "
                  >
                    ‚ö†Ô∏è X√≥a h·ªçc sinh
                  </div>
                  <select
                    id="deleteStudentSelect"
                    style="
                      width: 100%;
                      padding: 10px;
                      border-radius: 8px;
                      border: 1px solid #ddd;
                      margin-bottom: 10px;
                    "
                  >
                    <option value="">-- Ch·ªçn h·ªçc sinh c·∫ßn x√≥a --</option>
                  </select>
                  <button
                    onclick="deleteStudent()"
                    style="
                      background: linear-gradient(45deg, #ff4757, #ff6b6b);
                      color: white;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 12px;
                      cursor: pointer;
                      width: 100%;
                      font-weight: 600;
                    "
                  >
                    üóëÔ∏è X√≥a h·ªçc sinh
                  </button>
                </div>

                <h4 style="margin: 20px 0 15px">X√≥a d·ªØ li·ªáu</h4>
                <div style="display: flex; flex-direction: column; gap: 10px">
                  <button
                    onclick="clearAllStudents()"
                    style="
                      background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
                      color: white;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 12px;
                      cursor: pointer;
                    "
                  >
                    X√≥a t·∫•t c·∫£ h·ªçc sinh
                  </button>
                  <button
                    onclick="resetAllGroups()"
                    style="
                      background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
                      color: white;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 12px;
                      cursor: pointer;
                    "
                  >
                    X√≥a t·∫•t c·∫£ nh√≥m
                  </button>
                  <button
                    onclick="resetAllData()"
                    style="
                      background: linear-gradient(45deg, #ff4757, #ff6b6b);
                      color: white;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 12px;
                      cursor: pointer;
                    "
                  >
                    X√≥a to√†n b·ªô d·ªØ li·ªáu
                  </button>
                </div>

                <div
                  style="
                    margin-top: 30px;
                    padding: 20px;
                    background: linear-gradient(
                      135deg,
                      #f8f9fa 0%,
                      #e9ecef 100%
                    );
                    border-radius: 15px;
                    text-align: center;
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                  "
                >
                  <div
                    style="
                      color: #ff6f00;
                      font-size: 1.5rem;
                      font-weight: 700;
                      margin-bottom: 12px;
                    "
                  >
                    ·ª®ng d·ª•ng qu·∫£n l√≠ l·ªõp h·ªçc ƒê∆∞·ªùng ƒë·∫øn ng√¥i vua
                  </div>
                  <div
                    style="
                      color: #495057;
                      font-size: 1rem;
                      font-weight: 600;
                      margin-bottom: 10px;
                    "
                  >
                    T√°c gi·∫£: Ng√¥ Th·ªã M·ªπ Ng·ªçc
                  </div>
                  <div
                    style="
                      color: #495057;
                      font-size: 0.95rem;
                      margin-bottom: 10px;
                    "
                  >
                    Email: ngongoc231294@gmail.com
                  </div>
                  <div
                    style="
                      color: #6c757d;
                      font-size: 0.95rem;
                      font-style: italic;
                    "
                  >
                    ·ª®ng d·ª•ng h·ªó tr·ª£ qu·∫£n l√≠ l·ªõp h·ªçc hi·ªáu qu·∫£
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ƒê·ªïi qu√† -->
        <div id="rewards-tab" class="tab-content">
          <div class="devices-section">
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
              "
            >
              <h3 style="color: #4a5568; font-size: 1.5rem; margin: 0">
                üéÅ ƒê·ªïi qu√† - V·∫≠t ph·∫©m theo c·∫•p b·∫≠c
              </h3>
              <div style="display: flex; gap: 10px">
                <button
                  onclick="toggleExchangePointsSection()"
                  id="toggleExchangeBtn"
                  style="
                    background: linear-gradient(45deg, #ffa726, #ffd54f);
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 12px;
                    cursor: pointer;
                    font-weight: 600;
                    transition: all 0.3s;
                  "
                >
                  üí∞ ƒê·ªïi ƒëi·ªÉm
                </button>
                <button
                  onclick="toggleRewardEditor()"
                  id="toggleEditorBtn"
                  style="
                    background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 12px;
                    cursor: pointer;
                    font-weight: 600;
                    transition: all 0.3s;
                  "
                >
                  ‚úèÔ∏è Ch·ªânh s·ª≠a v·∫≠t ph·∫©m
                </button>
              </div>
            </div>

            <!-- Editor ·∫©n/hi·ªán -->
            <div
              id="rewardEditorContainer"
              style="
                display: none;
                background: #f8f9fa;
                border-radius: 16px;
                padding: 20px;
                margin-bottom: 30px;
                border: 2px solid #6bcf7f;
              "
            >
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 20px;
                "
              >
                <h4 style="margin: 0; color: #333; font-size: 1.5rem">
                  üìù Ch·ªânh s·ª≠a th√¥ng tin v·∫≠t ph·∫©m
                </h4>
                <button
                  onclick="saveRewardItems()"
                  style="
                    background: linear-gradient(45deg, #ffca28, #ffe082);
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 12px;
                    cursor: pointer;
                    font-weight: 600;
                  "
                >
                  üíæ L∆∞u thay ƒë·ªïi
                </button>
              </div>
              <div id="rewardItemsEditor">
                <!-- Form nh·∫≠p li·ªáu s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông -->
              </div>
            </div>

            <!-- Section ƒê·ªïi ƒëi·ªÉm (·∫©n m·∫∑c ƒë·ªãnh) -->
            <div
              id="exchangePointsSection"
              style="
                display: none;
                background: #f8f9fa;
                border-radius: 16px;
                padding: 20px;
                margin-bottom: 30px;
                border: 2px solid #ffa726;
              "
            >
              <h4
                style="
                  margin: 0 0 20px 0;
                  color: #333;
                  font-size: 1.2rem;
                  font-weight: 700;
                "
              >
                üí∞ Danh s√°ch ƒë·ªïi ƒëi·ªÉm
              </h4>
              <div
                style="
                  background: white;
                  border-radius: 12px;
                  overflow-x: auto;
                  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                "
              >
                <table
                  style="
                    width: 100%;
                    border-collapse: collapse;
                    min-width: 1200px;
                  "
                >
                  <thead>
                    <tr
                      style="
                        background: linear-gradient(
                          135deg,
                          #ffa726 0%,
                          #ffd54f 100%
                        );
                        color: white;
                      "
                    >
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: center;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 50px;
                        "
                      >
                        STT
                      </th>
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: left;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 120px;
                        "
                      >
                        T√™n
                      </th>
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: center;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 100px;
                        "
                      >
                        C·∫•p b·∫≠c
                      </th>
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: center;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 80px;
                        "
                      >
                        ƒêi·ªÉm
                      </th>
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: center;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 500px;
                        "
                      >
                        Qu√† ƒë∆∞·ª£c ƒë·ªïi
                      </th>
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: center;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 100px;
                        "
                      >
                        T·ªïng ƒëi·ªÉm ƒë·ªïi
                      </th>
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: center;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 100px;
                        "
                      >
                        ƒê·ªïi ƒëi·ªÉm
                      </th>
                      <th
                        style="
                          padding: 12px 8px;
                          text-align: center;
                          font-weight: bold;
                          border: 1px solid rgba(255, 255, 255, 0.3);
                          width: 100px;
                        "
                      >
                        ƒêi·ªÉm c√≤n l·∫°i
                      </th>
                    </tr>
                  </thead>
                  <tbody id="exchangePointsTableBody">
                    <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Grid hi·ªÉn th·ªã v·∫≠t ph·∫©m -->
            <div id="rewardsGrid" class="student-grid">
              <!-- Th·∫ª v·∫≠t ph·∫©m s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
          </div>
        </div>

        <!-- B√°o c√°o -->
        <div id="reports-tab" class="tab-content">
          <div class="devices-section">
            <h3 style="color: #4a5568; margin-bottom: 20px; font-size: 1.5rem">
              B√°o c√°o v√† th·ªëng k√™
            </h3>
            <div
              style="
                display: flex;
                gap: 15px;
                margin-bottom: 20px;
                flex-wrap: wrap;
                align-items: center;
              "
            >
              <div style="display: flex; gap: 10px; align-items: center">
                <label style="font-weight: 600">T·ª´ ng√†y:</label>
                <input
                  type="date"
                  id="startDate"
                  style="
                    padding: 8px;
                    border-radius: 8px;
                    border: 1px solid #eee;
                  "
                />
              </div>
              <div style="display: flex; gap: 10px; align-items: center">
                <label style="font-weight: 600">ƒê·∫øn ng√†y:</label>
                <input
                  type="date"
                  id="endDate"
                  style="
                    padding: 8px;
                    border-radius: 8px;
                    border: 1px solid #eee;
                  "
                />
              </div>
              <button
                class="btn-auto"
                onclick="generateReport()"
                style="
                  background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
                  color: white;
                  border: none;
                  padding: 10px 20px;
                  border-radius: 12px;
                  cursor: pointer;
                "
              >
                T·∫°o b√°o c√°o
              </button>
              <button
                class="btn-auto"
                onclick="exportToExcel()"
                style="
                  background: linear-gradient(45deg, #ffca28, #ffe082);
                  color: white;
                  border: none;
                  padding: 10px 20px;
                  border-radius: 12px;
                  cursor: pointer;
                "
              >
                Xu·∫•t Excel
              </button>
              <button
                class="btn-auto"
                onclick="showImportExcelModal()"
                style="
                  background: linear-gradient(45deg, #42a5f5, #ff7043);
                  color: white;
                  border: none;
                  padding: 10px 20px;
                  border-radius: 12px;
                  cursor: pointer;
                "
              >
                Nh·∫≠p d·ªØ li·ªáu
              </button>
            </div>
            <div id="reportContent"></div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="panel-collapsible"
      style="position: fixed; top: 20px; right: 20px; z-index: 1000"
    >
      <div class="panel-content" id="quickPanel">
        <div style="font-weight: 700; margin-bottom: 8px">
          Th√™m nhi·ªÅu h·ªçc sinh
        </div>
        <textarea
          id="bulkStudentNamesTop"
          rows="4"
          style="
            width: 100%;
            padding: 10px;
            border-radius: 12px;
            border: 1px solid #eee;
          "
        ></textarea>
        <div style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap">
          <button
            class="chip-btn"
            onclick="handleAddMultipleStudents('bulkStudentNamesTop')"
            style="
              background: linear-gradient(45deg, #ffca28, #ffe082);
              color: #fff;
              border: none;
              padding: 8px 12px;
              border-radius: 12px;
              cursor: pointer;
            "
          >
            Th√™m h·ªçc sinh
          </button>
        </div>
        <hr
          style="margin: 12px 0; border: none; height: 1px; background: #f0f0f0"
        />
        <div style="font-weight: 700; margin-bottom: 8px">Th√™m nhi·ªÅu nh√≥m</div>
        <textarea
          id="bulkGroupNamesTop"
          rows="3"
          style="
            width: 100%;
            padding: 10px;
            border-radius: 12px;
            border: 1px solid #eee;
          "
        ></textarea>
        <div style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap">
          <button
            class="chip-btn"
            onclick="handleAddMultipleGroups('bulkGroupNamesTop')"
            style="
              background: linear-gradient(45deg, #ffca28, #ffe082);
              color: #fff;
              border: none;
              padding: 8px 12px;
              border-radius: 12px;
              cursor: pointer;
            "
          >
            Th√™m nh√≥m
          </button>
        </div>
      </div>
    </div>

    <div
      id="settingsModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2000;
      "
    >
      <div
        style="
          background: #fff;
          width: 720px;
          max-width: 95vw;
          border-radius: 16px;
          padding: 16px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
          "
        >
          <div style="font-weight: 800; font-size: 1.5rem">C√†i ƒë·∫∑t</div>
          <button
            class="chip-btn"
            onclick="closeSettings()"
            style="
              background: linear-gradient(45deg, #ffca28, #ffe082);
              color: #fff;
              border: none;
              padding: 8px 12px;
              border-radius: 12px;
              cursor: pointer;
            "
          >
            ƒê√≥ng
          </button>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px">
          <div>
            <div style="font-weight: 700; margin-bottom: 6px">
              Th√™m h·ªçc sinh (m·ªói d√≤ng m·ªôt t√™n)
            </div>
            <textarea
              id="bulkStudentNamesSettings"
              rows="6"
              style="
                width: 100%;
                padding: 10px;
                border-radius: 12px;
                border: 1px solid #eee;
              "
            ></textarea>
            <div style="margin-top: 8px">
              <button
                class="chip-btn"
                onclick="handleAddMultipleStudents('bulkStudentNamesSettings')"
                style="
                  background: linear-gradient(45deg, #ffca28, #ffe082);
                  color: #fff;
                  border: none;
                  padding: 8px 12px;
                  border-radius: 12px;
                  cursor: pointer;
                "
              >
                Th√™m
              </button>
            </div>
            <div style="font-weight: 700; margin: 14px 0 6px">
              Th√™m nh√≥m (m·ªói d√≤ng m·ªôt t√™n)
            </div>
            <textarea
              id="bulkGroupNamesSettings"
              rows="5"
              style="
                width: 100%;
                padding: 10px;
                border-radius: 12px;
                border: 1px solid #eee;
              "
            ></textarea>
            <div style="margin-top: 8px">
              <button
                class="chip-btn"
                onclick="handleAddMultipleGroups('bulkGroupNamesSettings')"
                style="
                  background: linear-gradient(45deg, #ffca28, #ffe082);
                  color: #fff;
                  border: none;
                  padding: 8px 12px;
                  border-radius: 12px;
                  cursor: pointer;
                "
              >
                Th√™m
              </button>
            </div>
          </div>
          <div>
            <div style="font-weight: 700; margin-bottom: 6px">
              ƒêi·ªÉm y√™u c·∫ßu m·ªói m·ªëc
            </div>
            <div id="thresholdEditor"></div>
            <div style="margin-top: 10px">
              <button
                class="chip-btn"
                onclick="saveThresholds()"
                style="
                  background: linear-gradient(45deg, #ffca28, #ffe082);
                  color: #fff;
                  border: none;
                  padding: 8px 12px;
                  border-radius: 12px;
                  cursor: pointer;
                "
              >
                L∆∞u m·ªëc
              </button>
            </div>

            <hr
              style="
                margin: 20px 0;
                border: none;
                height: 1px;
                background: #f0f0f0;
              "
            />

            <div style="font-weight: 700; margin-bottom: 15px; color: #333">
              üìä Thi·∫øt l·∫≠p b·∫£ng ƒëi·ªÉm
            </div>

            <!-- ƒêi·ªÉm C·ªông -->
            <div style="margin-bottom: 25px">
              <div
                style="
                  font-weight: 700;
                  margin-bottom: 10px;
                  color: #28a745;
                  font-size: 1.5rem;
                "
              >
                ‚úÖ ƒêi·ªÉm C·ªông:
              </div>
              <div
                id="addCriteriaContainer"
                style="
                  background: #f8f9fa;
                  border: 2px solid #e0e0e0;
                  border-radius: 12px;
                  padding: 15px;
                  margin-bottom: 10px;
                "
              >
                <!-- Ti√™u ch√≠ s·∫Ω ƒë∆∞·ª£c load ·ªü ƒë√¢y -->
              </div>
              <button
                onclick="addNewCriteria('add')"
                style="
                  background: linear-gradient(45deg, #4caf50, #66bb6a);
                  color: white;
                  border: none;
                  padding: 10px 20px;
                  border-radius: 10px;
                  cursor: pointer;
                  font-weight: bold;
                  width: 100%;
                "
              >
                + Th√™m ti√™u ch√≠
              </button>
            </div>

            <!-- ƒêi·ªÉm Tr·ª´ -->
            <div style="margin-bottom: 25px">
              <div
                style="
                  font-weight: 700;
                  margin-bottom: 10px;
                  color: #dc3545;
                  font-size: 1.5rem;
                "
              >
                ‚ùå ƒêi·ªÉm Tr·ª´:
              </div>
              <div
                id="subtractCriteriaContainer"
                style="
                  background: #f8f9fa;
                  border: 2px solid #e0e0e0;
                  border-radius: 12px;
                  padding: 15px;
                  margin-bottom: 10px;
                "
              >
                <!-- Ti√™u ch√≠ s·∫Ω ƒë∆∞·ª£c load ·ªü ƒë√¢y -->
              </div>
              <button
                onclick="addNewCriteria('subtract')"
                style="
                  background: linear-gradient(45deg, #f44336, #ef5350);
                  color: white;
                  border: none;
                  padding: 10px 20px;
                  border-radius: 10px;
                  cursor: pointer;
                  font-weight: bold;
                  width: 100%;
                "
              >
                + Th√™m ti√™u ch√≠
              </button>
            </div>

            <button
              onclick="saveAllCriteria()"
              style="
                background: linear-gradient(45deg, #ffca28, #ffe082);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 12px;
                cursor: pointer;
                font-weight: bold;
                width: 100%;
                font-size: 1.5rem;
              "
            >
              üíæ L∆∞u t·∫•t c·∫£
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="addGroupModal" class="addNewGroup">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title">Th√™m nh√≥m m·ªõi</div>
          <button class="btn-close" onclick="closeAddGroupModal()">ƒê√≥ng</button>
        </div>

        <div class="modal-body">
          <label class="label">T√™n nh√≥m:</label>
          <textarea
            id="newGroupName"
            rows="6"
            placeholder="M·ªói d√≤ng 1 t√™n nh√≥m"
            class="textarea"
          ></textarea>
        </div>

        <div class="modal-footer">
          <button class="btn-cancel" onclick="closeAddGroupModal()">H·ªßy</button>
          <button class="btn-create" onclick="createNewGroup()">
            T·∫°o nh√≥m
          </button>
        </div>
      </div>
    </div>

    <div id="deleteGroupModal" class="deleteCurrentGroup">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title">X√≥a nh√≥m</div>
          <button class="btn-close" onclick="closeDeleteGroupModal()">ƒê√≥ng</button>
        </div>

        <div class="modal-body">
          <label class="label">Ch·ªçn nh√≥m ƒë·ªÉ x√≥a:</label>
          <select id="deleteGroupSelect" class="select">
            <option value="">Ch·ªçn nh√≥m...</option>
          </select>
        </div>

        <div class="modal-footer">
          <button class="btn-cancel" onclick="closeDeleteGroupModal()">H·ªßy</button>
          <button class="btn-delete" onclick="deleteSelectedGroup()">X√≥a nh√≥m</button>
        </div>
      </div>
    </div>


    <!-- Modal Timer -->
    <div
      id="timerModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2000;
      "
    >
      <div
        style="
          background: #fff;
          width: 700px;
          max-width: 95vw;
          border-radius: 20px;
          padding: 40px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
          "
        >
          <div style="font-weight: 800; font-size: 1.8rem">B·∫•m gi·ªù</div>
          <button
            onclick="closeTimerModal()"
            style="
              background: #ff6b6b;
              color: #fff;
              border: none;
              padding: 12px 20px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            ƒê√≥ng
          </button>
        </div>
        <div style="text-align: center; margin-bottom: 30px">
          <div
            style="
              font-size: 4.5rem;
              font-weight: bold;
              color: #ffa726;
              margin-bottom: 30px;
            "
            id="timerDisplayModal"
          >
            00:00:00
          </div>
          <div
            style="
              display: flex;
              gap: 15px;
              justify-content: center;
              flex-wrap: wrap;
            "
          >
            <button
              onclick="startCountdown()"
              style="
                background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
                color: #fff;
                border: none;
                padding: 15px 30px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1.5rem;
                font-weight: 600;
              "
            >
              ƒê·∫øm ng∆∞·ª£c
            </button>
            <button
              onclick="startStopwatch()"
              style="
                background: linear-gradient(45deg, #ffca28, #ffe082);
                color: #fff;
                border: none;
                padding: 15px 30px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1.5rem;
                font-weight: 600;
              "
            >
              ƒê·∫øm th·ªùi gian
            </button>
            <button
              onclick="stopTimer()"
              style="
                background: #ff6b6b;
                color: #fff;
                border: none;
                padding: 15px 30px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1.5rem;
                font-weight: 600;
              "
            >
              D·ª´ng
            </button>
          </div>
          <div style="margin-top: 30px">
            <label
              style="
                font-weight: 700;
                margin-bottom: 12px;
                display: block;
                font-size: 1.5rem;
              "
              >Th·ªùi gian ƒë·∫øm ng∆∞·ª£c:</label
            >
            <div
              style="
                display: flex;
                gap: 15px;
                justify-content: center;
                align-items: center;
              "
            >
              <div>
                <label
                  style="
                    font-size: 1rem;
                    color: #666;
                    margin-bottom: 8px;
                    display: block;
                  "
                  >Ph√∫t:</label
                >
                <input
                  type="number"
                  id="countdownMinutes"
                  value="5"
                  min="0"
                  max="59"
                  style="
                    width: 100px;
                    padding: 12px;
                    border-radius: 8px;
                    border: 1px solid #eee;
                    text-align: center;
                    font-size: 1.5rem;
                  "
                />
              </div>
              <div>
                <label
                  style="
                    font-size: 1rem;
                    color: #666;
                    margin-bottom: 8px;
                    display: block;
                  "
                  >Gi√¢y:</label
                >
                <input
                  type="number"
                  id="countdownSeconds"
                  value="0"
                  min="0"
                  max="59"
                  style="
                    width: 100px;
                    padding: 12px;
                    border-radius: 8px;
                    border: 1px solid #eee;
                    text-align: center;
                    font-size: 1.5rem;
                  "
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Random Call -->
    <div
      id="randomCallModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2000;
      "
    >
      <div
        style="
          background: #fff;
          width: 800px;
          max-width: 95vw;
          border-radius: 20px;
          padding: 40px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
          "
        >
          <div style="font-weight: 800; font-size: 1.8rem">
            G·ªçi t√™n ng·∫´u nhi√™n
          </div>
          <button
            onclick="closeRandomCallModal()"
            style="
              background: #ff6b6b;
              color: #fff;
              border: none;
              padding: 12px 20px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            ƒê√≥ng
          </button>
        </div>
        <div style="text-align: center">
          <div style="margin-bottom: 30px">
            <label
              style="
                font-weight: 700;
                margin-bottom: 12px;
                display: block;
                font-size: 1.5rem;
              "
              >Ch·ªçn s·ªë l∆∞·ª£ng (1-5):</label
            >
            <select
              id="randomCount"
              style="
                padding: 12px 20px;
                border-radius: 12px;
                border: 1px solid #eee;
                font-size: 1.5rem;
                width: 200px;
              "
            >
              <option value="1">1 ng∆∞·ªùi</option>
              <option value="2">2 ng∆∞·ªùi</option>
              <option value="3">3 ng∆∞·ªùi</option>
              <option value="4">4 ng∆∞·ªùi</option>
              <option value="5">5 ng∆∞·ªùi</option>
            </select>
          </div>
          <div
            style="
              font-size: 3rem;
              font-weight: bold;
              color: #ffa726;
              margin-bottom: 30px;
              min-height: 100px;
              display: flex;
              align-items: center;
              justify-content: center;
              padding: 20px;
            "
            id="randomNameDisplay"
          >
            B·∫•m ƒë·ªÉ b·∫Øt ƒë·∫ßu
          </div>
          <div
            style="
              display: flex;
              gap: 15px;
              justify-content: center;
              align-items: center;
              flex-wrap: wrap;
            "
          >
            <button
              id="randomCallButton"
              onclick="toggleRandomCall()"
              style="
                background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
                color: #fff;
                border: none;
                padding: 18px 40px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1.3rem;
                font-weight: 600;
              "
            >
              B·∫Øt ƒë·∫ßu
            </button>
            <button
              onclick="resetCalledStudents()"
              style="
                background: linear-gradient(45deg, #ffca28, #ffe082);
                color: #333;
                border: none;
                padding: 12px 24px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1rem;
                font-weight: 600;
              "
            >
              üîÑ Reset danh s√°ch
            </button>
          </div>
          <div
            style="margin-top: 20px; font-size: 0.95rem; color: #666"
            id="calledStudentsInfo"
          >
            ƒê√£ g·ªçi: 0/${students.length || 0} h·ªçc sinh
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Sound Meter -->
    <div
      id="soundModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2000;
      "
    >
      <div
        style="
          background: #fff;
          width: 700px;
          max-width: 95vw;
          border-radius: 20px;
          padding: 40px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
          "
        >
          <div style="font-weight: 800; font-size: 1.8rem">ƒêo √¢m thanh</div>
          <button
            onclick="closeSoundModal()"
            style="
              background: #ff6b6b;
              color: #fff;
              border: none;
              padding: 12px 20px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            ƒê√≥ng
          </button>
        </div>
        <div style="text-align: center">
          <div
            style="
              display: flex;
              gap: 15px;
              justify-content: center;
              margin-bottom: 30px;
              flex-wrap: wrap;
            "
          >
            <button
              onclick="startNoiseMeter()"
              style="
                background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
                color: #fff;
                border: none;
                padding: 15px 30px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1.5rem;
                font-weight: 600;
              "
            >
              ƒêo ti·∫øng ·ªìn
            </button>
            <button
              onclick="startReadingMeter()"
              style="
                background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
                color: #fff;
                border: none;
                padding: 15px 30px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1.5rem;
                font-weight: 600;
              "
            >
              Luy·ªán ƒë·ªçc to
            </button>
          </div>
          <div
            style="
              margin-bottom: 30px;
              padding: 20px;
              background: #f8f9fa;
              border-radius: 12px;
            "
          >
            <div
              style="
                display: flex;
                align-items: center;
                gap: 20px;
                margin-bottom: 15px;
                flex-wrap: wrap;
              "
            >
              <label
                style="
                  font-weight: 600;
                  color: #333;
                  min-width: 120px;
                  text-align: left;
                  font-size: 1.5rem;
                "
                >ƒê·ªô nh·∫°y:</label
              >
              <input
                type="range"
                id="sensitivitySlider"
                min="0.1"
                max="3.0"
                step="0.1"
                value="1.0"
                style="
                  flex: 1;
                  min-width: 200px;
                  height: 8px;
                  border-radius: 3px;
                  background: #ddd;
                  outline: none;
                  -webkit-appearance: none;
                "
              />
              <span
                id="sensitivityValue"
                style="
                  font-weight: bold;
                  color: #4a5568;
                  min-width: 150px;
                  text-align: right;
                  font-size: 1.5rem;
                "
                >1.0x (‚âà100dB)</span
              >
            </div>
            <div
              style="
                font-size: 0.9rem;
                color: #666;
                margin-top: 10px;
                text-align: center;
              "
            >
              üí° ƒê·ªô nh·∫°y c√†ng cao, m·ª©c dB y√™u c·∫ßu c√†ng th·∫•p. Chu·∫©n: 100dB (ƒë·ªô
              nh·∫°y 1.0x)
            </div>
          </div>
          <div style="margin-bottom: 30px">
            <div
              style="
                font-size: 2.5rem;
                font-weight: bold;
                color: #333;
                margin-bottom: 15px;
              "
              id="soundLevelDisplay"
            >
              0 dB
            </div>
            <div
              style="
                width: 100%;
                height: 30px;
                background: #f0f0f0;
                border-radius: 15px;
                overflow: hidden;
                margin-bottom: 15px;
              "
            >
              <div
                id="soundBar"
                style="
                  height: 100%;
                  background: linear-gradient(90deg, #6bcf7f, #ffd93d, #ff6b6b);
                  width: 0%;
                  transition: width 0.3s ease;
                "
              ></div>
            </div>
            <div style="font-size: 1.5rem; font-weight: bold" id="soundStatus">
              Ch·ªçn ch·∫ø ƒë·ªô ƒëo
            </div>
          </div>
          <button
            onclick="stopSoundMeter()"
            style="
              background: #ccc;
              color: #333;
              border: none;
              padding: 15px 30px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1.5rem;
              font-weight: 600;
            "
          >
            D·ª´ng
          </button>
        </div>
      </div>
    </div>

    <!-- Modal Nh·∫≠p d·ªØ li·ªáu Excel -->
    <div
      id="importExcelModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2000;
      "
    >
      <div
        style="
          background: #fff;
          width: 700px;
          max-width: 95vw;
          border-radius: 20px;
          padding: 40px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
          "
        >
          <div style="font-weight: 800; font-size: 1.8rem">
            üì• Nh·∫≠p d·ªØ li·ªáu t·ª´ Excel
          </div>
          <button
            onclick="closeImportExcelModal()"
            style="
              background: #ff6b6b;
              color: #fff;
              border: none;
              padding: 12px 20px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            ƒê√≥ng
          </button>
        </div>
        <div style="display: flex; flex-direction: column; gap: 20px">
          <!-- N√∫t T·∫£i m·∫´u file -->
          <button
            onclick="downloadExcelTemplate()"
            style="
              background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
              color: white;
              border: none;
              padding: 12px 24px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
              width: 100%;
            "
          >
            üì• T·∫£i m·∫´u file
          </button>

          <!-- Nh·∫≠p d·ªØ li·ªáu -->
          <div>
            <label
              style="
                display: block;
                font-weight: 600;
                margin-bottom: 10px;
                color: #4a5568;
                font-size: 1rem;
              "
              >Nh·∫≠p d·ªØ li·ªáu:</label
            >
            <input
              type="file"
              id="excelFileInput"
              accept=".xlsx,.xls"
              style="
                width: 100%;
                padding: 12px;
                border-radius: 8px;
                border: 1px solid #ddd;
                margin-bottom: 15px;
                font-size: 0.95rem;
              "
            />
            <button
              onclick="importExcelData()"
              style="
                background: linear-gradient(45deg, #42a5f5, #ff7043);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1rem;
                font-weight: 600;
                width: 100%;
              "
            >
              üìä Nh·∫≠p d·ªØ li·ªáu
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal L·ªãch s·ª≠ -->
    <div
      id="historyModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2000;
      "
    >
      <div
        style="
          background: #fff;
          width: 1000px;
          max-width: 95vw;
          max-height: 90vh;
          border-radius: 20px;
          padding: 40px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
          display: flex;
          flex-direction: column;
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
          "
        >
          <div
            style="
              font-weight: 800;
              font-size: 1.8rem;
              display: flex;
              align-items: center;
              gap: 10px;
            "
          >
            <svg
              width="28"
              height="28"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <circle
                cx="12"
                cy="12"
                r="9"
                stroke="currentColor"
                stroke-width="2.5"
                fill="none"
                stroke-dasharray="20 4"
                stroke-dashoffset="2"
              />
              <line
                x1="12"
                y1="12"
                x2="9.5"
                y2="9.5"
                stroke="currentColor"
                stroke-width="3"
                stroke-linecap="round"
              />
              <line
                x1="12"
                y1="12"
                x2="14.5"
                y2="16.5"
                stroke="currentColor"
                stroke-width="2.5"
                stroke-linecap="round"
              />
              <path
                d="M19 5 Q22 7 22 10 Q22 13 19 15"
                stroke="currentColor"
                stroke-width="2.5"
                fill="none"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path d="M19 15 L17 13 L19 11 Z" fill="currentColor" />
            </svg>
            L·ªãch s·ª≠ c·ªông ƒëi·ªÉm
          </div>
          <button
            onclick="closeHistoryModal()"
            style="
              background: #ff6b6b;
              color: #fff;
              border: none;
              padding: 12px 20px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            ƒê√≥ng
          </button>
        </div>
        <div style="flex: 1; overflow-y: auto; margin-bottom: 20px">
          <div
            id="historyList"
            style="display: flex; flex-direction: column; gap: 10px"
          >
            <!-- N·ªôi dung l·ªãch s·ª≠ s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
          </div>
        </div>
        <div
          style="
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            align-items: center;
            padding-top: 20px;
            border-top: 2px solid #eee;
          "
        >
          <button
            onclick="deleteSelectedHistoryItems()"
            id="deleteSelectedBtn"
            style="
              background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
              color: #fff;
              border: none;
              padding: 12px 24px;
              border-radius: 12px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
              display: none;
            "
          >
            X√≥a ƒë√£ ch·ªçn
          </button>
        </div>
      </div>
    </div>

    <!-- Modal Hi·ªÉn th·ªã h·ªçc sinh trong nh√≥m -->
    <div
      id="groupStudentsModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2000;
      "
    >
      <div
        style="
          background: #fff;
          width: 740px;
          max-width: 95vw;
          max-height: calc(70vh + 50px);
          border-radius: 20px;
          padding: 40px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
          display: flex;
          flex-direction: column;
        "
      >
        <!-- Header v·ªõi icon settings v√† dropdown -->
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
          "
        >
          <div style="display: flex; align-items: center; gap: 15px">
            <div style="position: relative">
              <button
                id="groupSettingsBtn"
                onclick="toggleGroupSettingsDropdown()"
                style="
                  background: none;
                  border: none;
                  cursor: pointer;
                  padding: 8px;
                  font-size: 1.5rem;
                "
              >
                ‚öôÔ∏è
              </button>
              <div
                id="groupSettingsDropdown"
                style="
                  position: absolute;
                  top: 100%;
                  left: 0;
                  background: #fff;
                  border: 1px solid #ddd;
                  border-radius: 8px;
                  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                  padding: 8px 0;
                  margin-top: 5px;
                  min-width: 180px;
                  display: none;
                  z-index: 10;
                "
              >
                <button
                  onclick="showEditGroupModal()"
                  style="
                    width: 100%;
                    text-align: left;
                    padding: 10px 15px;
                    border: none;
                    background: none;
                    cursor: pointer;
                    color: #333;
                    font-size: 0.95rem;
                  "
                  onmouseover="this.style.background='#f5f5f5'"
                  onmouseout="this.style.background='none'"
                >
                  Ch·ªânh s·ª≠a nh√≥m
                </button>
                <button
                  onclick="deleteCurrentGroup()"
                  style="
                    width: 100%;
                    text-align: left;
                    padding: 10px 15px;
                    border: none;
                    background: none;
                    cursor: pointer;
                    color: #f44336;
                    font-size: 0.95rem;
                  "
                  onmouseover="this.style.background='#f5f5f5'"
                  onmouseout="this.style.background='none'"
                >
                  Xo√° nh√≥m
                </button>
              </div>
            </div>
            <div
              style="font-weight: 800; font-size: 1.8rem"
              id="groupStudentsModalTitle"
            >
              2
            </div>
          </div>
          <button
            onclick="closeGroupStudentsModal()"
            style="
              background: none;
              border: none;
              cursor: pointer;
              font-size: 1.5rem;
              color: #333;
              padding: 8px;
            "
          >
            ‚úï
          </button>
        </div>
        <!-- Main content v·ªõi th·∫ª h·ªçc sinh -->
        <div
          style="
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
          "
        >
          <div
            id="groupStudentsContent"
            style="
              display: flex;
              flex-wrap: wrap;
              gap: 20px;
              justify-content: center;
              align-items: center;
              width: 100%;
            "
          >
            <!-- N·ªôi dung h·ªçc sinh s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Ch·ªânh s·ª≠a nh√≥m -->
    <div
      id="editGroupModal"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.25);
        z-index: 2001;
      "
    >
      <div
        style="
          background: #fff;
          width: 800px;
          max-width: 95vw;
          max-height: 90vh;
          border-radius: 20px;
          padding: 40px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
          display: flex;
          flex-direction: column;
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
          "
        >
          <div
            style="font-weight: 800; font-size: 1.8rem"
            id="editGroupModalTitle"
          >
            Ch·ªânh s·ª≠a nh√≥m
          </div>
          <button
            onclick="closeEditGroupModal()"
            style="
              background: none;
              border: none;
              cursor: pointer;
              font-size: 1.5rem;
              color: #333;
              padding: 8px;
            "
          >
            ‚úï
          </button>
        </div>
        <div style="flex: 1; overflow-y: auto; margin-bottom: 20px">
          <div style="margin-bottom: 20px">
            <label
              style="
                display: block;
                font-weight: 600;
                margin-bottom: 10px;
                font-size: 1rem;
              "
              >T√™n nh√≥m:</label
            >
            <input
              type="text"
              id="editGroupName"
              style="
                width: 100%;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 8px;
                font-size: 1rem;
              "
            />
          </div>
          <div style="margin-bottom: 20px">
            <label
              style="
                display: block;
                font-weight: 600;
                margin-bottom: 10px;
                font-size: 1rem;
              "
              >Th√†nh vi√™n trong nh√≥m:</label
            >
            <div
              id="editGroupMembers"
              style="
                max-height: 400px;
                overflow-y: auto;
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 15px;
              "
            >
              <!-- Danh s√°ch h·ªçc sinh s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
            </div>
          </div>
          <div style="margin-bottom: 20px">
            <label
              style="
                display: block;
                font-weight: 600;
                margin-bottom: 10px;
                font-size: 1rem;
              "
              >Th√™m h·ªçc sinh:</label
            >
            <div
              id="addStudentToGroupList"
              style="
                max-height: 300px;
                overflow-y: auto;
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 15px;
                background: #f8f9fa;
              "
            >
              <!-- Danh s√°ch h·ªçc sinh s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
            </div>
          </div>
        </div>
        <div style="display: flex; gap: 10px; justify-content: flex-end">
          <button
            onclick="closeEditGroupModal()"
            style="
              background: #ccc;
              color: #333;
              border: none;
              padding: 12px 24px;
              border-radius: 8px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            H·ªßy
          </button>
          <button
            onclick="addStudentToGroupFromEdit()"
            style="
              background: linear-gradient(45deg, #42a5f5, #ff7043);
              color: #fff;
              border: none;
              padding: 12px 24px;
              border-radius: 8px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            Th√™m h·ªçc sinh ƒë√£ ch·ªçn
          </button>
          <button
            onclick="saveEditGroup()"
            style="
              background: linear-gradient(45deg, #6bcf7f, #4ecdc4);
              color: #fff;
              border: none;
              padding: 12px 24px;
              border-radius: 8px;
              cursor: pointer;
              font-size: 1rem;
              font-weight: 600;
            "
          >
            L∆∞u
          </button>
        </div>
      </div>
    </div>

    <!-- Modal B·∫£ng ƒëi·ªÉm c·ªông tr·ª´ -->
    <div
      id="pointBoardModal"
      onclick="closePointBoardModal()"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        backdrop-filter: blur(5px);
      "
    >
      <div
        onclick="event.stopPropagation()"
        style="
          background: white;
          width: 1200px;
          max-width: 95vw;
          border-radius: 20px;
          padding: 0;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
          overflow: hidden;
        "
      >
        <!-- Header -->
        <div
          style="
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: white;
            text-align: center;
            position: relative;
          "
        >
          <h2
            style="
              margin: 0;
              font-size: 1.8rem;
              font-weight: 800;
              text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            "
          >
            üìä B·∫£ng ƒêi·ªÉm C·ªông Tr·ª´
          </h2>
        </div>

        <!-- Tabs -->
        <div
          style="
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
          "
        >
          <button
            id="pointBoardAddTab"
            onclick="switchPointBoardTab('add')"
            style="
              flex: 1;
              padding: 15px;
              border: none;
              background: #28a745;
              color: white;
              font-weight: bold;
              cursor: pointer;
              transition: all 0.3s;
              font-size: 1rem;
            "
          >
            ‚úÖ ƒêi·ªÉm C·ªông
          </button>
          <button
            id="pointBoardSubtractTab"
            onclick="switchPointBoardTab('subtract')"
            style="
              flex: 1;
              padding: 15px;
              border: none;
              background: #6c757d;
              color: white;
              font-weight: bold;
              cursor: pointer;
              transition: all 0.3s;
              font-size: 1rem;
            "
          >
            ‚ùå ƒêi·ªÉm Tr·ª´
          </button>
        </div>

        <!-- N·ªôi dung Tab -->
        <div style="padding: 30px">
          <div
            id="pointBoardAddContent"
            style="
              display: grid;
              grid-template-columns: repeat(6, 1fr);
              gap: 15px;
            "
          >
            <!-- N·ªôi dung s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
          </div>
          <div
            id="pointBoardSubtractContent"
            style="
              display: none;
              grid-template-columns: repeat(6, 1fr);
              gap: 15px;
            "
          >
            <!-- N·ªôi dung s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông -->
          </div>
        </div>

        <!-- Footer -->
        <div
          style="
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-top: 2px solid #e9ecef;
          "
        >
          <button
            onclick="closePointBoardModal()"
            style="
              background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
              color: white;
              border: none;
              padding: 12px 40px;
              border-radius: 12px;
              cursor: pointer;
              font-weight: bold;
              font-size: 1rem;
            "
          >
            ƒê√≥ng
          </button>
        </div>
      </div>
    </div>

    <script src="js/script.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/actions.js"></script>
  </body>
</html>
